<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PPI Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 min-h-screen py-8">
    <div class="container mx-auto px-4">
        <h1 class="text-4xl font-bold text-center mb-8 text-gray-800">PPI Calculator</h1>
        
        <!-- Calculator Cards Container -->
        <div id="calculatorsContainer" class="space-y-6 mb-8">
            <!-- Initial calculator card will be added by JavaScript -->
        </div>
        
        <!-- Add Calculator Button -->
        <div class="flex justify-center mb-12">
            <button id="addCalculatorBtn" class="bg-blue-500 hover:bg-blue-600 text-white rounded-full w-12 h-12 flex items-center justify-center text-2xl shadow-lg transition-colors">
                +
            </button>
        </div>
        
        <!-- Summary Table -->
        <div class="bg-white rounded-lg shadow-lg p-6">
            <h2 class="text-2xl font-bold mb-4 text-gray-800">Summary</h2>
            <div class="overflow-x-auto">
                <table class="w-full table-auto">
                    <thead>
                        <tr class="bg-gray-200">
                            <th class="px-4 py-2 text-left">Monitor</th>
                            <th class="px-4 py-2 text-left">Resolution</th>
                            <th class="px-4 py-2 text-left">Diagonal</th>
                            <th class="px-4 py-2 text-left">PPI</th>
                            <th class="px-4 py-2 text-left">PPI²</th>
                            <th class="px-4 py-2 text-left">Dot Pitch</th>
                            <th class="px-4 py-2 text-left">Total Pixels</th>
                        </tr>
                    </thead>
                    <tbody id="summaryTableBody">
                        <tr>
                            <td colspan="7" class="px-4 py-8 text-center text-gray-500">No monitors added yet</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let calculatorCount = 0;
        const calculators = new Map();

        // PPI Calculation Functions
        function calculatePPI(width, height, diagonal) {
            if (diagonal <= 0) return null;
            const diagonalPixels = Math.sqrt(width * width + height * height);
            return diagonalPixels / diagonal;
        }

        function calculateDotPitch(ppi) {
            if (ppi <= 0) return null;
            return 25.4 / ppi; // Convert to mm
        }

        function calculateTotalPixels(width, height) {
            return width * height;
        }

        function formatNumber(num, decimals = 2) {
            return num.toFixed(decimals);
        }

        function formatPixels(pixels) {
            return pixels.toLocaleString();
        }

        // Helper function to update output fields
        function updateOutputFields(cardId, data) {
            document.querySelector(`[data-output="ppi"][data-card-id="${cardId}"]`).textContent = 
                data.ppi !== null ? formatNumber(data.ppi, 2) : '-';
            document.querySelector(`[data-output="ppi2"][data-card-id="${cardId}"]`).textContent = 
                data.ppi2 !== null ? formatNumber(data.ppi2, 0) : '-';
            document.querySelector(`[data-output="dotpitch"][data-card-id="${cardId}"]`).textContent = 
                data.dotPitch !== null ? formatNumber(data.dotPitch, 3) : '-';
            document.querySelector(`[data-output="pixels"][data-card-id="${cardId}"]`).textContent = 
                data.totalPixels !== null ? formatPixels(data.totalPixels) : '-';
        }

        // Helper function to reset output fields
        function resetOutputFields(cardId) {
            document.querySelector(`[data-output="ppi"][data-card-id="${cardId}"]`).textContent = '-';
            document.querySelector(`[data-output="ppi2"][data-card-id="${cardId}"]`).textContent = '-';
            document.querySelector(`[data-output="dotpitch"][data-card-id="${cardId}"]`).textContent = '-';
            document.querySelector(`[data-output="pixels"][data-card-id="${cardId}"]`).textContent = '-';
        }

        // Create a new calculator card
        function createCalculatorCard() {
            calculatorCount++;
            const cardId = `calc-${calculatorCount}`;
            
            const card = document.createElement('div');
            card.id = cardId;
            card.className = 'bg-white rounded-lg shadow-lg p-6 relative';
            card.innerHTML = `
                <div class="flex justify-between items-start mb-4">
                    <h3 class="text-xl font-semibold text-gray-800">Monitor ${calculatorCount}</h3>
                    <button class="remove-btn text-red-500 hover:text-red-700 text-xl font-bold" data-card-id="${cardId}">
                        ×
                    </button>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Resolution Width (px)</label>
                        <input type="number" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                               data-input="width" data-card-id="${cardId}" placeholder="1920">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Resolution Height (px)</label>
                        <input type="number" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                               data-input="height" data-card-id="${cardId}" placeholder="1080">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">Diagonal Size (inches)</label>
                        <input type="number" step="0.1" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                               data-input="diagonal" data-card-id="${cardId}" placeholder="24">
                    </div>
                </div>
                
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 bg-gray-50 p-4 rounded-md">
                    <div>
                        <div class="text-sm text-gray-600">PPI</div>
                        <div class="text-lg font-semibold text-gray-800" data-output="ppi" data-card-id="${cardId}">-</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">PPI²</div>
                        <div class="text-lg font-semibold text-gray-800" data-output="ppi2" data-card-id="${cardId}">-</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">Dot Pitch (mm)</div>
                        <div class="text-lg font-semibold text-gray-800" data-output="dotpitch" data-card-id="${cardId}">-</div>
                    </div>
                    <div>
                        <div class="text-sm text-gray-600">Total Pixels</div>
                        <div class="text-lg font-semibold text-gray-800" data-output="pixels" data-card-id="${cardId}">-</div>
                    </div>
                </div>
            `;
            
            document.getElementById('calculatorsContainer').appendChild(card);
            
            // Initialize calculator data
            calculators.set(cardId, {
                width: null,
                height: null,
                diagonal: null,
                ppi: null,
                ppi2: null,
                dotPitch: null,
                totalPixels: null
            });
            
            // Add event listeners for inputs
            const inputs = card.querySelectorAll('input');
            inputs.forEach(input => {
                input.addEventListener('input', handleInputChange);
            });
            
            // Add event listener for remove button
            card.querySelector('.remove-btn').addEventListener('click', handleRemoveCard);
            
            updateSummaryTable();
        }

        // Handle input changes
        function handleInputChange(event) {
            const cardId = event.target.dataset.cardId;
            const inputType = event.target.dataset.input;
            const value = parseFloat(event.target.value);
            
            const data = calculators.get(cardId);
            data[inputType] = isNaN(value) ? null : value;
            
            // Calculate if all inputs are present and valid (> 0 also checks for null/undefined)
            if (data.width > 0 && data.height > 0 && data.diagonal > 0) {
                data.ppi = calculatePPI(data.width, data.height, data.diagonal);
                data.ppi2 = data.ppi * data.ppi;
                data.dotPitch = calculateDotPitch(data.ppi);
                data.totalPixels = calculateTotalPixels(data.width, data.height);
                updateOutputFields(cardId, data);
            } else {
                // Reset outputs if inputs are incomplete or invalid
                resetOutputFields(cardId);
            }
            
            updateSummaryTable();
        }

        // Handle remove card
        function handleRemoveCard(event) {
            const cardId = event.target.dataset.cardId;
            const card = document.getElementById(cardId);
            card.remove();
            calculators.delete(cardId);
            updateSummaryTable();
        }

        // Update summary table
        function updateSummaryTable() {
            const tbody = document.getElementById('summaryTableBody');
            tbody.innerHTML = '';
            
            if (calculators.size === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="px-4 py-8 text-center text-gray-500">No monitors added yet</td></tr>';
                return;
            }
            
            calculators.forEach((data, cardId) => {
                const monitorNumber = cardId.split('-')[1];
                const row = document.createElement('tr');
                row.className = 'border-b hover:bg-gray-50';
                
                const resolution = data.width && data.height ? `${data.width} × ${data.height}` : '-';
                const diagonal = data.diagonal ? `${data.diagonal}"` : '-';
                const ppi = data.ppi ? formatNumber(data.ppi, 2) : '-';
                const ppi2 = data.ppi2 ? formatNumber(data.ppi2, 0) : '-';
                const dotPitch = data.dotPitch ? formatNumber(data.dotPitch, 3) + ' mm' : '-';
                const pixels = data.totalPixels ? formatPixels(data.totalPixels) : '-';
                
                row.innerHTML = `
                    <td class="px-4 py-2">Monitor ${monitorNumber}</td>
                    <td class="px-4 py-2">${resolution}</td>
                    <td class="px-4 py-2">${diagonal}</td>
                    <td class="px-4 py-2">${ppi}</td>
                    <td class="px-4 py-2">${ppi2}</td>
                    <td class="px-4 py-2">${dotPitch}</td>
                    <td class="px-4 py-2">${pixels}</td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // Add calculator button handler
        document.getElementById('addCalculatorBtn').addEventListener('click', createCalculatorCard);

        // Create initial calculator card
        createCalculatorCard();
    </script>
</body>
</html>
